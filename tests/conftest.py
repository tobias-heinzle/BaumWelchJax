
import jax
import jax.numpy as jnp

from baum_welch_jax.models import HiddenMarkovModel

HMM_TRIVIAL = HiddenMarkovModel(
    T=jnp.eye(5, dtype=jnp.float32),
    O=jnp.eye(5, dtype=jnp.float32),
    mu=jnp.ones(5, dtype=jnp.float32) / 5,
    is_log=False)

T_TEST = jnp.array([
	[0.19243171477714208, 0.09946564190896066,
	    0.4439127902794604, 0.2641898530344369],
	[0.2215117405382594, 0.14771091996193145,
	    0.36750680309584327, 0.26327053640396586],
	[0.32567255150556024, 0.11692843689351555,
	    0.5211349750555743, 0.036264036545349994],
	[0.24484103351668982, 0.378291183258554, 0.22909508709830506, 0.1477726961264511]
], jnp.float32)
MU_TEST = jnp.array([0.05993654841717721, 0.23018769503097294,
                    0.2884215553662816, 0.4214542011855682], jnp.float32)
O_TEST = jnp.array([
	[0.3424294274086979, 0.11983697254176293, 0.5377336000495392],
	[0.6033797336240794, 0.3331317294720829, 0.06348853690383766],
	[0.3752778951585183, 0.25413603861678963, 0.3705860662246921],
	[0.2132723459115592, 0.5360110824786332, 0.2507165716098077]
], jnp.float32)

HMM_TEST = HiddenMarkovModel(T=T_TEST, O=O_TEST, mu=MU_TEST)

# These test values below were computed based on 2_000_000 sequences of length 5,
# sampled with the above parameters
TEST_SEQUENCES_5_STEPS = [
	jnp.array([1, 1, 2, 0, 2]).astype(jnp.int32),
	jnp.array([1, 0, 2, 2, 1]).astype(jnp.int32),
	jnp.array([2, 2, 0, 1, 2]).astype(jnp.int32),
	jnp.array([2, 2, 1, 2, 0]).astype(jnp.int32),
	jnp.array([2, 0, 0, 1, 0]).astype(jnp.int32),
	jnp.array([1, 0, 0, 1, 1]).astype(jnp.int32),
	jnp.array([1, 0, 2, 1, 0]).astype(jnp.int32),
	jnp.array([0, 1, 2, 2, 1]).astype(jnp.int32),
	jnp.array([1, 2, 2, 1, 2]).astype(jnp.int32),
]


TEST_LIKELIHOODS_5_STEPS = [0.0048215, 0.0050975, 0.0030375,
                            0.0029755, 0.0040675, 0.004294, 0.0056415, 0.003161, 0.003826, ]
FINAL_STATE_DISTR_5_STEPS = [
	jnp.array([0.39966815306439907, 0.026444052680701026,
	          0.4697708182101006, 0.10411697604479933]),
	jnp.array([0.11387935262383521, 0.16410004904364886,
	          0.4289357528200098, 0.29308484551250613]),
	jnp.array([0.42041152263374487, 0.03901234567901234, 0.44, 0.1005761316872428]),
	jnp.array([0.23004537052596202, 0.22349185010922534,
	          0.45941858511174594, 0.08704419425306671]),
	jnp.array([0.23577135832821144, 0.3071911493546404,
	          0.3838967424708052, 0.07314074984634296]),
	jnp.array([0.11294829995342338, 0.24673963670237542,
	          0.37505822077317186, 0.26525384257102935]),
	jnp.array([0.23504387131082158, 0.30213595674909155,
	          0.3845608437472304, 0.07825932819285651]),
	jnp.array([0.11198987662132237, 0.1743119266055046,
	          0.41932932616260676, 0.29436887061056627]),
	jnp.array([0.4278619968635651, 0.03750653423941453,
	          0.4309984317825405, 0.10363303711447988]),
]

TEST_SEQUENCES_7_STEPS = [
	jnp.array([1, 1, 2, 0, 2, 1, 0]).astype(jnp.int32),
	jnp.array([1, 0, 2, 2, 1, 0, 2]).astype(jnp.int32),
	jnp.array([2, 2, 0, 1, 2, 1, 2]).astype(jnp.int32),
	jnp.array([2, 2, 1, 2, 0, 2, 1]).astype(jnp.int32),
	jnp.array([2, 0, 0, 1, 0, 2, 2]).astype(jnp.int32),
	jnp.array([1, 0, 0, 1, 1, 1, 2]).astype(jnp.int32),
	jnp.array([1, 0, 2, 1, 0, 2, 0]).astype(jnp.int32),
	jnp.array([0, 1, 2, 2, 1, 2, 1]).astype(jnp.int32),
	jnp.array([1, 2, 2, 1, 2, 0, 0]).astype(jnp.int32),
]
TEST_LIKELIHOODS_7_STEPS = [0.0005035, 0.000698, 0.0002645,
                            0.0002795, 0.0004985, 0.0003825, 0.000756, 0.0003085, 0.000527, ]


STATE_DISTR_5_STEPS = [
	jnp.array([[0.02063673130768433, 0.11116872342631962, 0.38286840194960076, 0.22741885305402884, 0.39966815306439907], [0.20854505859172456, 0.3245877838846832, 0.03743648242248263, 0.2119672301151094, 0.026444052680701026], [
	          0.16499014829409936, 0.32126931452867363, 0.4464378305506585, 0.4867779736596495, 0.4697708182101006], [0.6058280618064917, 0.24297417816032355, 0.13325728507725812, 0.07383594317121228, 0.10411697604479933]]),
	jnp.array([[0.01569396763119176, 0.21343795978420793, 0.3730259931338892, 0.4607160372731731, 0.11387935262383521], [0.17861696910250122, 0.3933300637567435, 0.024423737126042178, 0.02883766552231486, 0.16410004904364886], [
	          0.19156449239823442, 0.3300637567435017, 0.48160863168219714, 0.3965669445806768, 0.4289357528200098], [0.6141245708680726, 0.06316821971554684, 0.1209416380578715, 0.11387935262383521, 0.29308484551250613]]),
	jnp.array([[0.128559670781893, 0.40427983539094653, 0.25810699588477365, 0.1157201646090535, 0.42041152263374487], [0.06024691358024691, 0.042633744855967076, 0.24, 0.17185185185185184, 0.03901234567901234], [
	          0.46699588477366255, 0.43588477366255146, 0.40674897119341563, 0.4651851851851852, 0.44], [0.3441975308641975, 0.11720164609053497, 0.0951440329218107, 0.24724279835390947, 0.1005761316872428]]),
	jnp.array([[0.11493866577045875, 0.4696689631994623, 0.1235086540077298, 0.39842043354058143, 0.23004537052596202], [0.06200638548143169, 0.047891110737691145, 0.1545958662409679, 0.033103680053772476, 0.22349185010922534], [
	          0.47151739203495213, 0.3832969248865737, 0.47151739203495213, 0.45269702570996473, 0.45941858511174594], [0.35153755671315745, 0.0991430011762729, 0.2503780877163502, 0.1157788606956814, 0.08704419425306671]]),
	jnp.array([[0.10743700061462814, 0.2169637369391518, 0.27203441917639826, 0.10055316533497234, 0.23577135832821144], [0.055931161647203444, 0.33017824216349106, 0.2599877074370006, 0.16533497234173325, 0.3071911493546404], [
	          0.40282728948985863, 0.37516902274124153, 0.3535341118623233, 0.4055316533497234, 0.3838967424708052], [0.4338045482483098, 0.07768899815611555, 0.1144437615242778, 0.328580208973571, 0.07314074984634296]]),
	jnp.array([[0.017000465766185375, 0.19177922682813228, 0.2614112715416861, 0.1264555193292967, 0.11294829995342338], [0.18292966930600837, 0.4046343735444807, 0.2851653469958081, 0.20586865393572426, 0.24673963670237542], [
	          0.18619003260363298, 0.3006520726595249, 0.33127619934792735, 0.3396599906846763, 0.37505822077317186], [0.6138798323241733, 0.10293432696786213, 0.12214718211457848, 0.32801583605030277, 0.26525384257102935]]),
	jnp.array([[0.014269254630860586, 0.21926792519719931, 0.45067801116724276, 0.10280953647079677, 0.23504387131082158], [0.17876451298413543, 0.3928919613577949, 0.030665603119737657, 0.162190906673757, 0.30213595674909155], [
	          0.19498360365151113, 0.3207480280067358, 0.3659487724895861, 0.41965789240450235, 0.3845608437472304], [0.6119826287334929, 0.06709208543826996, 0.15270761322343349, 0.3153416644509439, 0.07825932819285651]]),
	jnp.array([[0.05868396077190762, 0.1085099652008858, 0.40556785827269853, 0.45586839607719076, 0.11198987662132237], [0.4224928819993673, 0.22587788674470105, 0.04017715912685859, 0.03179373615944321, 0.1743119266055046], [
	          0.2706422018348624, 0.402404302435938, 0.46108826320784563, 0.3884846567541917, 0.41932932616260676], [0.2481809553938627, 0.26320784561847516, 0.09316671939259728, 0.12385321100917432, 0.29436887061056627]]),
	jnp.array([[0.017773131207527444, 0.4354417145844224, 0.426424464192368, 0.11500261369576581, 0.4278619968635651], [0.21602195504443283, 0.05279665446941976, 0.02770517511761631, 0.1706743335075797, 0.03750653423941453], [
	          0.24856246732880294, 0.4086513329848406, 0.4257710402509148, 0.4753005750130685, 0.4309984317825405], [0.5176424464192368, 0.10311029796131731, 0.12009932043910089, 0.23902247778358598, 0.10363303711447988]]),
]

TEST_SEQUENCES_6_STEPS = [
	jnp.array([1, 1, 2, 0, 2, 1]).astype(jnp.int32),
	jnp.array([1, 0, 2, 2, 1, 0]).astype(jnp.int32),
	jnp.array([2, 2, 0, 1, 2, 1]).astype(jnp.int32),
	jnp.array([2, 2, 1, 2, 0, 2]).astype(jnp.int32),
	jnp.array([2, 0, 0, 1, 0, 2]).astype(jnp.int32),
	jnp.array([1, 0, 0, 1, 1, 1]).astype(jnp.int32),
	jnp.array([1, 0, 2, 1, 0, 2]).astype(jnp.int32),
	jnp.array([0, 1, 2, 2, 1, 2]).astype(jnp.int32),
	jnp.array([1, 2, 2, 1, 2, 0]).astype(jnp.int32),
]

STATE_DISTR_6_STEPS = [
	jnp.array([[0.01384083044982699, 0.11418685121107267, 0.3879277201076509, 0.22106881968473663, 0.47097270280661285, 0.12149173394848135], [0.22029988465974626, 0.3221837754709727, 0.03729334871203383, 0.20722798923490965, 0.028450595924644367, 0.16262975778546712], [
	          0.17301038062283736, 0.3106497500961169, 0.4371395617070358, 0.4917339484813533, 0.394079200307574, 0.4413687043444829], [0.5928489042675894, 0.25297962322183776, 0.1376393694732795, 0.07996924259900039, 0.10649750096116878, 0.27450980392156865]]),
	jnp.array([[0.013808686919407481, 0.205372834546824, 0.3655536028119508, 0.47301029374843084, 0.10469495355259854, 0.2450414260607582], [0.17449158925433092, 0.39769018327893546, 0.02460456942003515, 0.02837057494350992, 0.15289982425307558, 0.29701230228471004], [
	          0.18629173989455183, 0.33090635199598295, 0.4880743158423299, 0.3843836304293246, 0.41526487572181775, 0.3811197589756465], [0.6254079839317098, 0.0660306301782576, 0.12176751192568416, 0.11423550087873462, 0.32714034647250817, 0.07682651267888527]]),
	jnp.array([[0.12754491017964073, 0.3976047904191617, 0.262874251497006, 0.11976047904191617, 0.474251497005988, 0.1155688622754491], [0.06467065868263473, 0.0407185628742515, 0.2467065868263473, 0.17964071856287425, 0.04431137724550898, 0.1658682634730539], [
	          0.45089820359281435, 0.43293413173652695, 0.4035928143712575, 0.4437125748502994, 0.36826347305389223, 0.41317365269461076], [0.3568862275449102, 0.12874251497005987, 0.08682634730538923, 0.2568862275449102, 0.11317365269461079, 0.30538922155688625]]),
	jnp.array([[0.11068702290076336, 0.4713740458015267, 0.12547709923664122, 0.37786259541984735, 0.2075381679389313, 0.3988549618320611], [0.057729007633587785, 0.046278625954198474, 0.15601145038167938, 0.040553435114503815, 0.20706106870229007, 0.02385496183206107], [
	          0.46469465648854963, 0.38549618320610685, 0.4833015267175573, 0.4713740458015267, 0.5219465648854962, 0.47853053435114506], [0.36688931297709926, 0.09685114503816794, 0.23520992366412213, 0.11020992366412213, 0.06345419847328244, 0.09875954198473283]]),
	jnp.array([[0.1017605633802817, 0.20246478873239437, 0.2686619718309859, 0.10492957746478873, 0.2278169014084507, 0.39753521126760566], [0.052464788732394366, 0.3397887323943662, 0.25035211267605634, 0.1704225352112676, 0.2908450704225352, 0.027464788732394368], [
	          0.40316901408450706, 0.3806338028169014, 0.3704225352112676, 0.4070422535211268, 0.423943661971831, 0.44577464788732396], [0.4426056338028169, 0.07711267605633802, 0.11056338028169015, 0.3176056338028169, 0.0573943661971831, 0.12922535211267605]]),
	jnp.array([[0.015358361774744027, 0.18771331058020477, 0.26493174061433444, 0.12414675767918089, 0.12244027303754267, 0.10665529010238908], [0.1885665529010239, 0.41168941979522183, 0.2986348122866894, 0.22098976109215018, 0.28284982935153585, 0.24104095563139932], [
	          0.18216723549488054, 0.2909556313993174, 0.31399317406143346, 0.31399317406143346, 0.3033276450511945, 0.36006825938566556], [0.6139078498293515, 0.10964163822525597, 0.12244027303754267, 0.3408703071672355, 0.29138225255972694, 0.29223549488054607]]),
	jnp.array([[0.013157894736842105, 0.21482793522267207, 0.4590080971659919, 0.09767206477732794, 0.2325404858299595, 0.39549595141700405], [0.18092105263157895, 0.39119433198380565, 0.0298582995951417, 0.16371457489878544, 0.2874493927125506, 0.026821862348178137], [
	          0.19964574898785425, 0.32894736842105265, 0.35931174089068824, 0.4339574898785425, 0.4149797570850202, 0.4597672064777328], [0.6062753036437247, 0.06503036437246963, 0.15182186234817813, 0.30465587044534415, 0.06503036437246963, 0.11791497975708502]]),
	jnp.array([[0.06076555023923445, 0.10622009569377991, 0.39473684210526316, 0.44019138755980863, 0.1215311004784689, 0.44019138755980863], [0.42248803827751197, 0.22009569377990432, 0.042105263157894736, 0.028708133971291867, 0.14880382775119616, 0.03588516746411483], [
	          0.2679425837320574, 0.40861244019138754, 0.47081339712918663, 0.42488038277511964, 0.5028708133971291, 0.43397129186602873], [0.24880382775119617, 0.26507177033492824, 0.0923444976076555, 0.10622009569377991, 0.22679425837320574, 0.08995215311004785]]),
	jnp.array([[0.014026684912760863, 0.42901128977078345, 0.43072186110160793, 0.12624016421484777, 0.4013000342114266, 0.23674307218611015], [0.2210058159425248, 0.05029079712624016, 0.028395484091686622, 0.1874786178583647, 0.0366062264796442, 0.23537461512145055], [
	          0.24358535750940813, 0.4105371193978789, 0.42148477591515565, 0.444064317482039, 0.44064317482039, 0.43824837495723573], [0.5213821416353062, 0.1101607937050975, 0.11939787889154978, 0.24221690044474856, 0.12145056448853918, 0.08963393773520356]]),
]

# The entries of this tensor represent P(s_k = i, s_(k+1) =j | obs). Again obtained through sampling,
# this represents the JOINT DISTRIBUTION OF ALL POSSIBLE TRANSITIONS at time k.
# It is estimated from 6 steps of the sequence, but contains only 5 matrices per sequence because each
# matrix uses information from the current and next step.
#
# (not to be confused with  P(s_(k+1) = j | s_k = i, obs), the distribution of transitioning into j
# given we are already in i)
TRANSITION_TENSORS_TEST_6_STEPS = [
	jnp.array([
            [
		[0.0012444260085035777, 0.0019703411801306647,
		    0.008503577724774447, 0.00891838639427564],
		[0.019910816136057243, 0.03266618272321892,
		    0.07404334750596288, 0.08192471222648554],
		[0.02675515918282692, 0.027792180856579904,
		    0.1007985066887898, 0.009644301565902727],
		[0.06325832209893187, 0.2621590791247537,
		    0.13792388260914654, 0.14248677797365966],
            ],
            [
		[0.030903245877838846, 0.002177745514881261,
		    0.056621383386912784, 0.021466348646686714],
		[0.10826506273981126, 0.009333195063776833,
		    0.13719796743751944, 0.06979155864357565],
		[0.13678315876801825, 0.006222130042517889,
		    0.17162708700611842, 0.006636938712019081],
		[0.10691693456393239, 0.019703411801306647,
		    0.08099139272010784, 0.035362439074976666],
            ],
            [
		[0.0718656019910816, 0.06004355491029763,
		    0.19921186352794773, 0.05174738152027377],
		[0.008503577724774447, 0.009436897231152132,
		    0.014725707767292337, 0.004770299699263714],
		[0.12382038784610598, 0.07134709115420512,
		    0.24432230633620242, 0.006948045214144976],
		[0.023229285492066785, 0.07113968681945453,
		    0.02851809602820699, 0.010370216737529815],
            ],
            [
		[0.06751011096131909, 0.004044384527636628,
		    0.11324276677382557, 0.042621590791247534],
		[0.07673960385772062, 0.00611842787514259,
		    0.0891838639427564, 0.039925334439489785],
		[0.22150782951363684, 0.010370216737529815,
		    0.24328528466244945, 0.011614642746033393],
		[0.03391060873172249, 0.005911023540391994,
		    0.02405890283106917, 0.009955408068028622],
            ],
            [
		[0.07622109302084414, 0.0387846105983615,
		    0.1790936430571399, 0.10556880638805351],
		[0.00611842787514259, 0.0039406823602613295,
		    0.009436897231152132, 0.006948045214144976],
		[0.1574198900757026, 0.05371772270040444,
		    0.24245566732344706, 0.01617753811054651],
		[0.02737737218707871, 0.035984652079228456,
		    0.024681115835320958, 0.016073835943171213],
            ],

	]),
	jnp.array([
            [
		[0.0018636586562040215, 0.0024521824423737125,
		    0.00912211868563021, 0.0022560078469838155],
		[0.0390387444825895, 0.04031387935262384,
		    0.078077488965179, 0.021186856302108877],
		[0.05247670426679745, 0.031093673369298677,
		    0.104757233938205, 0.0032368808239333006],
		[0.12005885237861696, 0.3194703285924473,
		    0.1381069151544875, 0.03648847474252084],
            ],
            [
		[0.05836194212849436, 0.0038254046101029917,
		    0.11309465424227562, 0.038155958803334965],
		[0.13997057381069153, 0.00980872976949485,
		    0.1746934771947033, 0.06885728298185385],
		[0.1439921530161844, 0.00519862677783227,
		    0.1737126042177538, 0.007160372731731241],
		[0.030701324178518882, 0.0055909759686120645,
		    0.020107896027464444, 0.006768023540951447],
            ],
            [
		[0.1381069151544875, 0.006964198136341344,
		    0.15193722412947525, 0.0760176557135851],
		[0.010004904364884748, 0.0012751348700343306,
		    0.009514467876410006, 0.0036292300147130947],
		[0.24894556154977932, 0.010985777341834233,
		    0.2064737616478666, 0.015203531142717018],
		[0.06365865620402159, 0.009612555174104953,
		    0.028641490926924962, 0.01902893575282001],
            ],
            [
		[0.034526728788621876, 0.043845022069641984,
		    0.1706718979892104, 0.21167238842569888],
		[0.0025502697400686613, 0.0036292300147130947,
		    0.008925944090240313, 0.01373222167729279],
		[0.06738597351642962, 0.06503187837175085,
		    0.22903384011770475, 0.03511525257479156],
		[0.009416380578715057, 0.05159391858754291,
		    0.02030407062285434, 0.0325649828347229],
            ],
            [
		[0.022461991172143207, 0.009710642471799901,
		    0.053948013732221675, 0.027758705247670427],
		[0.03688082393330064, 0.024816086316821973,
		    0.05865620402157921, 0.043746934771947035],
		[0.1472290338401177, 0.04943599803825405,
		    0.2159882295242766, 0.01628249141736145],
		[0.07395782246199117, 0.10769985286905345,
		    0.06473761647866601, 0.04668955370279549],
            ],

	]),
	jnp.array([
            [
		[0.033251028806584364, 0.0027983539094650206,
		    0.06271604938271605, 0.029794238683127573],
		[0.01728395061728395, 0.0023045267489711935,
		    0.027654320987654323, 0.013004115226337449],
		[0.20806584362139918, 0.009218106995884774,
		    0.23358024691358026, 0.016131687242798353],
		[0.145679012345679, 0.02831275720164609,
		    0.11193415637860082, 0.058271604938271604],
            ],
            [
		[0.08625514403292181, 0.06814814814814815,
		    0.17728395061728394, 0.0725925925925926],
		[0.010205761316872428, 0.01037037037037037,
		    0.01596707818930041, 0.006090534979423868],
		[0.13893004115226337, 0.09316872427983539,
		    0.19522633744855966, 0.008559670781893004],
		[0.02271604938271605, 0.06831275720164609,
		    0.018271604938271607, 0.007901234567901235],
            ],
            [
		[0.02139917695473251, 0.02666666666666667,
		    0.1094650205761317, 0.1005761316872428],
		[0.018765432098765432, 0.04098765432098765,
		    0.0819753086419753, 0.09827160493827161],
		[0.0660082304526749, 0.06436213991769547,
		    0.2511934156378601, 0.025185185185185185],
		[0.009547325102880658, 0.039835390946502056,
		    0.022551440329218107, 0.023209876543209877],
            ],
            [
		[0.03588477366255144, 0.0014814814814814814,
		    0.05563786008230453, 0.02271604938271605],
		[0.06189300411522634, 0.004773662551440329,
		    0.071440329218107, 0.03374485596707819],
		[0.20954732510288065, 0.011358024691358024,
		    0.23440329218106995, 0.009876543209876543],
		[0.11308641975308642, 0.02139917695473251,
		    0.07851851851851852, 0.034238683127572014],
            ],
            [
		[0.08164609053497943, 0.04098765432098765,
		    0.18584362139917696, 0.11193415637860082],
		[0.009711934156378601, 0.005761316872427984,
		    0.013333333333333334, 0.010205761316872428],
		[0.13991769547325103, 0.04905349794238683,
		    0.23522633744855967, 0.01580246913580247],
		[0.02617283950617284, 0.03917695473251029,
		    0.020411522633744857, 0.014814814814814815],
            ],

	]),
	jnp.array([
            [
		[0.04116955133590993, 0.0023525457906234245,
		    0.05074777348344816, 0.020668795160477232],
		[0.02486976978659049, 0.0021845068055788945,
		    0.023861535876323305, 0.011090573012939002],
		[0.23004537052596202, 0.011762728953117123,
		    0.21576205679717694, 0.013947235758696018],
		[0.17358427155099984, 0.0315913291883717,
		    0.09292555872962527, 0.05343639724416065],
            ],
            [
		[0.03864896656024198, 0.04621072088724584,
		    0.20299109393379264, 0.18181818181818182],
		[0.004200974626113258, 0.007897832297092925,
		    0.01545958662409679, 0.02033271719038817],
		[0.06973617879348008, 0.059149722735674676,
		    0.2298773315409175, 0.02453369181650143],
		[0.01092253402789447, 0.041337590320954465,
		    0.023189379936145185, 0.023693496891278778],
            ],
            [
		[0.03478406990421778, 0.0016803898504453034,
		    0.05797344984036296, 0.02907074441270375],
		[0.051756007393715345, 0.004200974626113258,
		    0.06351873634683247, 0.03512014787430684],
		[0.20047050915812467, 0.008065871282137456,
		    0.2505461267013947, 0.012434884893295245],
		[0.1114098470845236, 0.019156444295076458,
		    0.08065871282137456, 0.03915308351537557],
            ],
            [
		[0.07326499747941523, 0.06839186691312385,
		    0.19307679381616535, 0.063686775331877],
		[0.007729793312048395, 0.009410183162493698,
		    0.012098806923206184, 0.0038648966560241977],
		[0.12670139472357586, 0.08250714165686439,
		    0.23307007225676357, 0.01041841707276088],
		[0.022349185010922534, 0.0631826583767434,
		    0.02117291211561082, 0.009074105192404638],
            ],
            [
		[0.042681902201310705, 0.022517223995967065,
		    0.10216770290707444, 0.0626785414216098],
		[0.05141992942362628, 0.03058309527810452,
		    0.08217106368677533, 0.05931776172071921],
		[0.14636195597378593, 0.05410855318433876,
		    0.24382456729961352, 0.015123508654007729],
		[0.02016467820534364, 0.034447991934128716,
		    0.02083683414552176, 0.011594689968072593],
            ],

	]),
	jnp.array([
            [
		[0.01585740626920713, 0.015980331899200985,
		    0.054087277197295634, 0.0215119852489244],
		[0.012292562999385371, 0.011309157959434542,
		    0.023601720958819915, 0.008727719729563614],
		[0.107559926244622, 0.07191149354640443,
		    0.21204671173939765, 0.011309157959434542],
		[0.0812538414259373, 0.23097725875845113,
		    0.08543331284572833, 0.036140135218192995],
            ],
            [
		[0.04671173939766441, 0.04388444990780578,
		    0.08383527965580824, 0.042532267977873385],
		[0.08186846957590657, 0.09071911493546404,
		    0.10190534726490473, 0.05568531038721573],
		[0.12685925015365704, 0.08027043638598648,
		    0.15685310387215734, 0.011186232329440689],
		[0.016594960049170254, 0.04511370620774431,
		    0.01094038106945298, 0.005039950829748003],
            ],
            [
		[0.01684081130915796, 0.02937922556853104,
		    0.09465273509526737, 0.13116164720344192],
		[0.01979102642901045, 0.03491087891825446,
		    0.0759680393362016, 0.1293177627535341],
		[0.05384142593730793, 0.05912722802704364,
		    0.20897357098955133, 0.03159188690842041],
		[0.010079901659496005, 0.04191763982790412,
		    0.025937307928703135, 0.03650891210817456],
            ],
            [
		[0.020036877688998155, 0.015611555009219423,
		    0.04634296250768285, 0.01856177012907191],
		[0.03810694529809465, 0.03884449907805777,
		    0.06379840196681008, 0.024585125998770743],
		[0.11653349723417332, 0.07818070067609097,
		    0.20393362015980332, 0.0068838352796558085],
		[0.061094038106945296, 0.17455439459127228,
		    0.06982175783650892, 0.0231100184388445],
            ],
            [
		[0.04843269821757837, 0.023232944068838354,
		    0.10215119852489243, 0.06195451751690227],
		[0.0629379225568531, 0.04867854947756607,
		    0.10866625691456669, 0.08690842040565458],
		[0.12267977873386601, 0.04535955746773202,
		    0.20061462814996928, 0.015242778119237861],
		[0.018315918869084204, 0.02839582052858021,
		    0.0148740012292563, 0.01155500921942225],
            ],

	]),
	jnp.array([
            [
		[0.0029110386585933863, 0.0025617140195621797,
		    0.0069864927806241265, 0.004541220307405682],
		[0.03190498369818351, 0.04692594317652538,
		    0.06555659059152305, 0.03854215183977643],
		[0.04331625523986959, 0.03586399627387052,
		    0.10176991150442478, 0.005239869585468095],
		[0.1136469492314858, 0.3192827200745226,
		    0.12633907778295295, 0.05461108523521192],
            ],
            [
		[0.044014904517931996, 0.03982300884955752,
		    0.07172799254774104, 0.03621332091290173],
		[0.09326967862133209, 0.11935258500232883,
		    0.12307871448532837, 0.06893339543549139],
		[0.10398230088495575, 0.06776897997205403,
		    0.12109920819748486, 0.007801583605030275],
		[0.020144387517466233, 0.058220773171867725,
		    0.015370284117373078, 0.0091988821611551],
            ],
            [
		[0.02352119236143456, 0.030507685142058687,
		    0.07859804378202143, 0.1287843502561714],
		[0.02701443875174662, 0.05065207265952492,
		    0.07394038192827201, 0.13355845365626456],
		[0.06462505822077318, 0.06788542151839777,
		    0.16907312529110385, 0.02969259431765254],
		[0.011294829995342337, 0.0568234746157429,
		    0.018048439683278995, 0.035980437820214255],
            ],
            [
		[0.008500232883092687, 0.013740102468560783,
		    0.04937121564974383, 0.054843968327899395],
		[0.0183977643223102, 0.0351653469958081,
		    0.06089892873777364, 0.09140661387983233],
		[0.05344666977177457, 0.056939916162086636,
		    0.19911504424778761, 0.03015836050302748],
		[0.032603632976245925, 0.1408942710759199,
		    0.0656730321378668, 0.08884489986027014],
            ],
            [
		[0.018048439683278995, 0.010013972985561248,
		    0.053912435957149514, 0.030973451327433628],
		[0.05449464368886819, 0.038775034932463905,
		    0.09059152305542617, 0.06287843502561714],
		[0.12354448067070331, 0.04366557987890079,
		    0.19294364229156963, 0.014904517931998137],
		[0.0647414997671169, 0.10211923614345599,
		    0.056124825337680484, 0.042268281322775964],
            ],

	]),
	jnp.array([
            [
		[0.0024816095010192327, 0.0022157227687671717,
		    0.007799344146060445, 0.0017725782150137374],
		[0.03545156430027475, 0.04280776389258176,
		    0.07666400779934415, 0.02384117699193477],
		[0.057963307630949215, 0.030931489851989718,
		    0.10289816538154746, 0.0031906407870247273],
		[0.12337144376495612, 0.31693698484445626,
		    0.13338651067978374, 0.03828768944429673],
            ],
            [
		[0.07976601967561818, 0.00452007444828503,
		    0.08809713728618275, 0.04688469378711336],
		[0.16032969954799256, 0.012585305326597537,
		    0.13161393246477002, 0.08836302401843481],
		[0.17468758308960383, 0.007622086324559072,
		    0.1317025613755207, 0.0067357972170522026],
		[0.035894708854028186, 0.0059381370202960205,
		    0.014535141363112647, 0.010724098200833112],
            ],
            [
		[0.030754232030488344, 0.04174421696357352,
		    0.16015244172649118, 0.2180271204466897],
		[0.0031020118762740407, 0.004697332269786404,
		    0.008597004342816628, 0.014269254630860586],
		[0.05530444030842861, 0.05698838961269166,
		    0.2181157493574404, 0.03554019321102544],
		[0.013648852255605779, 0.058760967827705395,
		    0.032792696977754145, 0.047505096162368164],
            ],
            [
		[0.019498360365151114, 0.01808029779314012,
		    0.04865727200212709, 0.016573606310378446],
		[0.03226092351325002, 0.04112381458831871,
		    0.061419835150226004, 0.027386333421962245],
		[0.12053531862093415, 0.07489142958433041,
		    0.21563413985642116, 0.008597004342816628],
		[0.0627492688114863, 0.1680404147833023,
		    0.058849596738456085, 0.025702384117699192],
            ],
            [
		[0.04475759992909687, 0.02410706372418683,
		    0.1053797748825667, 0.0607994327749712],
		[0.06691482761676859, 0.04395993973234069,
		    0.11300186120712577, 0.07825932819285651],
		[0.12124434990693965, 0.04644154923335992,
		    0.20349197908357705, 0.013382965523353718],
		[0.019409731454400427, 0.029602056190729416,
		    0.017903039971638748, 0.011344500576087919],
            ],

	]),
	jnp.array([
            [
		[0.004428978171464726, 0.0060107560898449855,
		    0.023568490983865865, 0.024675735526732048],
		[0.03337551407782347, 0.06785827269851313,
		    0.1559633027522936, 0.1652957924707371],
		[0.0457133818411895, 0.044447959506485286,
		    0.16371401455235685, 0.01676684593483075],
		[0.0249920911104081, 0.10756089844985764,
		    0.0591584941474217, 0.05646947168617526],
            ],
            [
		[0.03242644732679532, 0.0031635558367605187,
		    0.056153116102499206, 0.01676684593483075],
		[0.08067067383739324, 0.006959822840873141,
		    0.1006010756089845, 0.037646314457450175],
		[0.1724137931034483, 0.006485289465359064,
		    0.21369819677317306, 0.009807023093957609],
		[0.12005694400506169, 0.023568490983865865,
		    0.09063587472318886, 0.028946535906358747],
            ],
            [
		[0.14378361278076557, 0.01012337867763366,
		    0.1627649478013287, 0.08889591901297057],
		[0.015343245808288516, 0.0014236001265422334,
		    0.014394179057260361, 0.009016134134767479],
		[0.24517557734894022, 0.011546978804175894,
		    0.19171148370768745, 0.012654223347042075],
		[0.051565960139196454, 0.008699778551091426,
		    0.019614046187915218, 0.013286934514394179],
            ],
            [
		[0.034799114204365704, 0.05077507118000633,
		    0.16055045871559634, 0.2097437519772224],
		[0.0018981335020563112, 0.0045871559633027525,
		    0.009016134134767479, 0.016292312559316673],
		[0.0621638721923442, 0.06833280607402721,
		    0.22587788674470105, 0.03211009174311927],
		[0.013128756722556154, 0.0506168933881683,
		    0.023884846567541917, 0.03622271433090794],
            ],
            [
		[0.021670357481809555, 0.012337867763366024,
		    0.0506168933881683, 0.027364757987978487],
		[0.03701360329009807, 0.025624802277760202,
		    0.06548560582094273, 0.046187915216703575],
		[0.13935463460930086, 0.04381524833913319,
		    0.2230306864916166, 0.013128756722556154],
		[0.07339449541284404, 0.1115153432458083,
		    0.06817462828218918, 0.04128440366972477],
            ],

	]),
	jnp.array([
            [
		[0.004181913225300575, 0.0, 0.010454783063251438, 0.0031364349189754314],
		[0.07762676424464192, 0.006272869837950863,
		    0.09539989545216937, 0.03672242550967068],
		[0.11003659174072138, 0.0035284892838473602,
		    0.13003136434918974, 0.004966021955044433],
		[0.2435964453737585, 0.04299529534762154,
		    0.17276529012023, 0.058285415577626766],
            ],
            [
		[0.14453737584945112, 0.008755880815473079,
		    0.1970726607422896, 0.08507579717720858],
		[0.021432305279665446, 0.0014375326711970726,
		    0.02025614218504966, 0.00967067433350758],
		[0.20713538944066912, 0.007318348144276007,
		    0.18256664924202823, 0.011630946157867224],
		[0.05331939362258233, 0.010193413486670152,
		    0.02587558808154731, 0.013721902770517512],
            ],
            [
		[0.0307109252483011, 0.0483533716675379, 0.17890747516989022, 0.1684526921066388],
		[0.0023523261892315736, 0.003920543648719289,
		    0.009539989545216936, 0.01189231573444851],
		[0.06717198118139049, 0.06704129639309984,
		    0.26202300052273914, 0.02953476215368531],
		[0.014767381076842655, 0.05135912179822269,
		    0.024830109775222164, 0.029142707788813383],
            ],
            [
		[0.031495033978044956, 0.0018295870360690017,
		    0.05867746994249869, 0.02300052273915316],
		[0.06312075274438056, 0.003789858860428646,
		    0.0696549921589127, 0.03410872974385781],
		[0.2183742812336644, 0.010585467851542081,
		    0.23301097752221642, 0.013329848405645583],
		[0.11487192890747518, 0.021301620491374806,
		    0.0696549921589127, 0.03319393622582331],
            ],
            [
		[0.08559853633037115, 0.04704652378463147,
		    0.18295870360690017, 0.1122582331416623],
		[0.008102456874019864, 0.005488761108207005,
		    0.013460533193936227, 0.010454783063251438],
		[0.1386565603763722, 0.05384213277574491,
		    0.22151071615263984, 0.016989022477783586],
		[0.025483533716675378, 0.040250914793518035,
		    0.024568740198640877, 0.013329848405645583],
            ],

	]),

]


T_TEST_STRUCTURED = jnp.array([
	[0.95, 0.05, 0.0, 0.0],
	[0.0, 0.95, 0.05, 0.0],
	[0.0, 0.0, 0.95, 0.05],
	[0.0, 0.0, 0.0, 1.0]
], jnp.float32)

MU_TEST_STRUCTURED = jnp.array(
    [0.964369788973432, 0.03440292143612942, 0.001227289590438528, 0.0], jnp.float32)

O_TEST_STRUCTURED = jnp.array([
	[0.7213991842739687, 0.2653879287722419, 0.013212886953789416],
	[0.3459541948223698, 0.44421397916166544, 0.20983182601596484],
	[0.2042705586529167, 0.39786472067354167, 0.39786472067354167],
	[0.0, 0.0, 1.0]
], jnp.float32)

HMM_TEST_STRUCTURED = HiddenMarkovModel(
    T=T_TEST_STRUCTURED, O=O_TEST_STRUCTURED, mu=MU_TEST_STRUCTURED)

OBS_DISTR_STRUCTURED_100_STEPS = jnp.array([
    [
        0.7107099890708923,
		0.6918299794197083,
		0.6723200082778931,
		0.6541600227355957,
		0.6407999992370605,
		0.6232200264930725,
		0.6065400242805481,
		0.5926100015640259,
		0.5726900100708008,
		0.5604400038719177,
		0.5444499850273132,
		0.533810019493103,
		0.516219973564148,
		0.505810022354126,
		0.49355000257492065,
		0.47940999269485474,
		0.4690000116825104,
		0.45482999086380005,
		0.44269001483917236,
		0.4269300103187561,
		0.41846001148223877,
		0.40738001465797424,
		0.39824000000953674,
		0.38628000020980835,
		0.37749001383781433,
		0.3660399913787842,
		0.3553600013256073,
		0.34828999638557434,
		0.339709997177124,
		0.3256700038909912,
		0.31692999601364136,
		0.3096100091934204,
		0.29892000555992126,
		0.29096001386642456,
		0.2818700075149536,
		0.2742899954319,
		0.2672399878501892,
		0.260019987821579,
		0.2520599961280823,
		0.2416200041770935,
		0.23567000031471252,
		0.22851000726222992,
		0.22347000241279602,
		0.21772000193595886,
		0.20906999707221985,
		0.20204000174999237,
		0.19678999483585358,
		0.1907999962568283,
		0.18598000705242157,
		0.1773499995470047,
		0.17601999640464783,
		0.16742999851703644,
		0.16436000168323517,
		0.1592700034379959,
		0.15387000143527985,
		0.14774000644683838,
		0.14410999417304993,
		0.13888999819755554,
		0.13586999475955963,
		0.13172000646591187,
		0.1262200027704239,
		0.12314999848604202,
		0.11984000355005264,
		0.11307000368833542,
		0.1100199967622757,
		0.10634999722242355,
		0.1041100025177002,
		0.09940999746322632,
		0.09775999933481216,
		0.0920799970626831,
		0.08888000249862671,
		0.08720999956130981,
		0.0832199975848198,
		0.08079999685287476,
		0.0792199969291687,
		0.07594999670982361,
		0.07263000309467316,
		0.0701799988746643,
		0.06904999911785126,
		0.06665000319480896,
		0.06362000107765198,
		0.06154999881982803,
		0.05908000096678734,
		0.057420000433921814,
		0.054499998688697815,
		0.05349000170826912,
		0.05076000094413757,
		0.04946000128984451,
		0.04799000173807144,
		0.045820001512765884,
		0.04433999955654144,
		0.04258999973535538,
		0.041189998388290405,
		0.040630001574754715,
		0.038589999079704285,
		0.037709999829530716,
		0.0357699990272522,
		0.033969998359680176,
		0.03223999962210655,
		0.0316600017249584
    ],
	[
        0.26903000473976135,
		0.27911001443862915,
		0.2876400053501129,
		0.29440999031066895,
		0.29872000217437744,
		0.3073500096797943,
		0.31338000297546387,
		0.3171499967575073,
		0.3258900046348572,
		0.3296400010585785,
		0.3330700099468231,
		0.3333300054073334,
		0.3374199867248535,
		0.338019996881485,
		0.3359600007534027,
		0.3368000090122223,
		0.33715999126434326,
		0.3385300040245056,
		0.33948999643325806,
		0.3401600122451782,
		0.3371700048446655,
		0.3358300030231476,
		0.3315599858760834,
		0.3308199942111969,
		0.32585999369621277,
		0.3251599967479706,
		0.32315999269485474,
		0.3156999945640564,
		0.3133600056171417,
		0.3111099898815155,
		0.30796000361442566,
		0.30452999472618103,
		0.2995400130748749,
		0.2949199974536896,
		0.29374000430107117,
		0.28613999485969543,
		0.2808699905872345,
		0.27487000823020935,
		0.27105000615119934,
		0.2667900025844574,
		0.2614099979400635,
		0.25655001401901245,
		0.2518500089645386,
		0.24560000002384186,
		0.2409300059080124,
		0.23544000089168549,
		0.23025000095367432,
		0.22476999461650848,
		0.21875999867916107,
		0.21762999892234802,
		0.20954999327659607,
		0.2064100056886673,
		0.20013999938964844,
		0.1955299973487854,
		0.19151000678539276,
		0.18764999508857727,
		0.18038000166416168,
		0.17719000577926636,
		0.17111000418663025,
		0.1662999987602234,
		0.16287000477313995,
		0.15775999426841736,
		0.15208999812602997,
		0.1496499925851822,
		0.1450899988412857,
		0.14173999428749084,
		0.13609999418258667,
		0.13384999334812164,
		0.12880000472068787,
		0.1271200031042099,
		0.12302999943494797,
		0.11810000240802765,
		0.1153699979186058,
		0.11072999984025955,
		0.10687000304460526,
		0.10486000031232834,
		0.10213000327348709,
		0.0989300012588501,
		0.09608999639749527,
		0.09305000305175781,
		0.089369997382164,
		0.08579999953508377,
		0.08369000256061554,
		0.08132000267505646,
		0.07976999878883362,
		0.07609999924898148,
		0.07457999885082245,
		0.07161000370979309,
		0.0684100016951561,
		0.06644999980926514,
		0.06458000093698502,
		0.06199000030755997,
		0.05961000174283981,
		0.057110000401735306,
		0.056370001286268234,
		0.054099999368190765,
		0.0530100017786026,
		0.05119999870657921,
		0.04983000084757805,
		0.047770000994205475
    ],
	[
        0.020260000601410866,
		0.02906000055372715,
		0.04004000127315521,
		0.051430001854896545,
		0.06047999858856201,
		0.06943000108003616,
		0.08008000254631042,
		0.0902400016784668,
		0.10142000019550323,
		0.10992000252008438,
		0.12247999757528305,
		0.132860004901886,
		0.14635999500751495,
		0.15616999566555023,
		0.17048999667167664,
		0.18378999829292297,
		0.19383999705314636,
		0.20664000511169434,
		0.21782000362873077,
		0.23291000723838806,
		0.2443699985742569,
		0.25679001212120056,
		0.2702000141143799,
		0.28290000557899475,
		0.2966499924659729,
		0.30880001187324524,
		0.32148000597953796,
		0.33601000905036926,
		0.34692999720573425,
		0.3632200062274933,
		0.375110000371933,
		0.38585999608039856,
		0.40154001116752625,
		0.41411998867988586,
		0.4243899881839752,
		0.43957000970840454,
		0.4518899917602539,
		0.46511000394821167,
		0.4768899977207184,
		0.4915899932384491,
		0.5029199719429016,
		0.5149400234222412,
		0.5246800184249878,
		0.5366799831390381,
		0.550000011920929,
		0.5625200271606445,
		0.5729600191116333,
		0.5844299793243408,
		0.5952600240707397,
		0.6050199866294861,
		0.6144300103187561,
		0.6261600255966187,
		0.6355000138282776,
		0.6452000141143799,
		0.6546199917793274,
		0.6646100282669067,
		0.6755099892616272,
		0.6839200258255005,
		0.6930199861526489,
		0.7019799947738647,
		0.7109100222587585,
		0.7190899848937988,
		0.7280700206756592,
		0.737280011177063,
		0.7448899745941162,
		0.7519099712371826,
		0.7597900032997131,
		0.7667400240898132,
		0.7734400033950806,
		0.7807999849319458,
		0.7880899906158447,
		0.7946900129318237,
		0.8014100193977356,
		0.8084700107574463,
		0.8139100074768066,
		0.8191900253295898,
		0.8252400159835815,
		0.8308899998664856,
		0.8348600268363953,
		0.8403000235557556,
		0.8470100164413452,
		0.852649986743927,
		0.857230007648468,
		0.8612599968910217,
		0.8657299876213074,
		0.8704100251197815,
		0.8746600151062012,
		0.8789299726486206,
		0.8835999965667725,
		0.8877300024032593,
		0.8910800218582153,
		0.8954200148582458,
		0.8992000222206116,
		0.9022600054740906,
		0.9050400257110596,
		0.9081900119781494,
		0.9112200140953064,
		0.9148300290107727,
		0.917930006980896,
		0.9205700159072876
        ]
    ]
)

TEST_SEQUENCES_STRUCTURED_5_STEPS = [
	jnp.array([0, 0, 1, 0, 1]).astype(jnp.int32),
	jnp.array([0, 0, 1, 1, 1]).astype(jnp.int32),
	jnp.array([1, 1, 0, 0, 1]).astype(jnp.int32),
	jnp.array([1, 1, 0, 1, 0]).astype(jnp.int32),
	jnp.array([0, 0, 0, 0, 0]).astype(jnp.int32),
	jnp.array([1, 0, 1, 0, 0]).astype(jnp.int32),
	jnp.array([0, 0, 1, 2, 1]).astype(jnp.int32),
	jnp.array([0, 2, 1, 0, 1]).astype(jnp.int32),
]
TEST_LIKELIHOODS_STRUCTURED_5_STEPS = [
    0.026176, 0.012832, 0.0096475, 0.0089175, 0.1608765, 0.0225225, 0.0026465, 0.001081, ]
FINAL_STATE_DISTR_STRUCTURED_5_STEPS = [
	jnp.array([0.7972188264058679, 0.19330684596577016, 0.009474327628361858, 0.0]),
	jnp.array([0.5939837905236908, 0.37651963840399, 0.029496571072319202, 0.0]),
	jnp.array([0.811401917595232, 0.17963202902306297, 0.008966053381705105, 0.0]),
	jnp.array([0.8543313708999158, 0.1377067563779086, 0.007961872722175498, 0.0]),
	jnp.array([0.9545645262048839, 0.0445932128060966,
	          0.0008422609890195274, 0.0]),
	jnp.array([0.9226551226551226, 0.07452547452547452,
	          0.0028194028194028194, 0.0]),
	jnp.array([0.13867372000755715, 0.7577933119214056, 0.10353296807103722, 0.0]),
	jnp.array([0.36077705827937095, 0.5786308973172988, 0.06059204440333025, 0.0]),
]


STATE_DISTR_STRUCTURED_5_STEPS = [
	jnp.array([[0.9906593826405868, 0.9608992970660146, 0.9000611246943765, 0.8654301650366748, 0.7972188264058679], [0.009283312958435208, 0.038890586797066015, 0.09862087408312958,
	          0.13059672982885084, 0.19330684596577016], [5.730440097799511e-05, 0.0002101161369193154, 0.0013180012224938875, 0.003973105134474328, 0.009474327628361858], [0.0, 0.0, 0.0, 0.0, 0.0]]),
	jnp.array([[0.9727634039900249, 0.8941708229426434, 0.7346477556109726, 0.6447163341645885, 0.5939837905236908], [0.02715866583541147, 0.1051278054862843, 0.26114401496259354,
	          0.3402041770573566, 0.37651963840399], [7.793017456359102e-05, 0.0007013715710723192, 0.004208229426433915, 0.015079488778054862, 0.029496571072319202], [0.0, 0.0, 0.0, 0.0, 0.0]]),
	jnp.array([[0.9636693443897383, 0.9355273386887795, 0.917491578129049, 0.8806944804353459, 0.811401917595232], [0.03617517491578129, 0.06385073853329878, 0.08084996112982638,
	          0.11593677118424463, 0.17963202902306297], [0.00015548069448043534, 0.0006219227779217414, 0.0016584607411246437, 0.0033687483804094327, 0.008966053381705105], [0.0, 0.0, 0.0, 0.0, 0.0]]),
	jnp.array([[0.9631062517521727, 0.9347911410148584, 0.9149425287356322, 0.8767591813849173, 0.8543313708999158], [0.03666947014297729, 0.06436781609195402, 0.08309503784693019,
	          0.1184749088870199, 0.1377067563779086], [0.00022427810485001402, 0.0008410428931875525, 0.0019624334174376226, 0.004765909728062798, 0.007961872722175498], [0.0, 0.0, 0.0, 0.0, 0.0]]),
	jnp.array([[0.9991608469851097, 0.9962890788897073, 0.9902906888203062, 0.9786047060944265, 0.9545645262048839], [0.0008391530148903041, 0.0037078131361634546, 0.00967201549014306,
	          0.02115597989762333, 0.0445932128060966], [0.0, 3.1079741292233484e-06, 3.729568955068018e-05, 0.0002393140079501978, 0.0008422609890195274], [0.0, 0.0, 0.0, 0.0, 0.0]]),
	jnp.array([[0.9886113886113886, 0.9787989787989788, 0.9581307581307581, 0.9466311466311467, 0.9226551226551226], [0.011322011322011322, 0.021045621045621046, 0.041314241314241315,
	          0.05201465201465202, 0.07452547452547452], [6.66000666000666e-05, 0.0001554001554001554, 0.000555000555000555, 0.0013542013542013542, 0.0028194028194028194], [0.0, 0.0, 0.0, 0.0, 0.0]]),
	jnp.array([[0.932552427734744, 0.7421122236916683, 0.3650103910825619, 0.1500094464386926, 0.13867372000755715], [0.06650292839599471, 0.25524277347440016, 0.6138295862459853,
	          0.7797090496882675, 0.7577933119214056], [0.0009446438692612885, 0.002645002833931608, 0.021160022671452863, 0.07028150387303986, 0.10353296807103722], [0.0, 0.0, 0.0, 0.0, 0.0]]),
	jnp.array([[0.8617021276595744, 0.42738205365402404, 0.3973172987974098, 0.3852913968547641, 0.36077705827937095], [0.13691026827012026, 0.5652173913043478, 0.5795559666975023,
	          0.57631822386679, 0.5786308973172988], [0.0013876040703052729, 0.0074005550416281225, 0.02312673450508788, 0.03839037927844589, 0.06059204440333025], [0.0, 0.0, 0.0, 0.0, 0.0]]),
]

TEST_SEQUENCES_STRUCTURED_6_STEPS = [
	jnp.array([0, 0, 1, 0, 1, 0]).astype(jnp.int32),
	jnp.array([0, 0, 1, 1, 1, 0]).astype(jnp.int32),
	jnp.array([1, 1, 0, 0, 1, 0]).astype(jnp.int32),
	jnp.array([1, 1, 0, 1, 0, 1]).astype(jnp.int32),
	jnp.array([0, 0, 0, 0, 0, 1]).astype(jnp.int32),
	jnp.array([0, 0, 0, 0, 0, 0]).astype(jnp.int32),
	jnp.array([1, 0, 1, 0, 0, 2]).astype(jnp.int32),
	jnp.array([0, 0, 1, 2, 1, 1]).astype(jnp.int32),
	jnp.array([0, 2, 1, 0, 1, 0]).astype(jnp.int32),
]
TEST_LIKELIHOODS_STRUCTURED_6_STEPS = [
    0.016484, 0.007041, 0.006145, 0.0026235, 0.0455935, 0.1100735, 0.0008835, 0.0011045, 0.0004995, ]

STATE_DISTR_STRUCTURED_6_STEPS = [
	jnp.array([[0.9949951468090269, 0.9788886192671682, 0.9463722397476341, 0.9283244358165493, 0.8910761950982771, 0.8690245086144139], [0.0049138558602281, 0.020929386071341906, 0.05320310604222276, 0.07043193399660276,
	          0.1062848823101189, 0.12515166221790827], [9.099733074496482e-05, 0.00018199466148992964, 0.00042465421014316915, 0.0012436301868478524, 0.0026389225916039795, 0.005823829167677748], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]]),
	jnp.array([[0.9855134213890072, 0.9382900156227808, 0.8447663684135777, 0.7910808123846045, 0.7599062633148701, 0.7405908251668797], [0.014486578610992756, 0.06149694645646925, 0.15352932822042323, 0.20330918903564835,
	          0.2293708280073853, 0.2417980400511291], [0.0, 0.00021303792074989347, 0.0017043033659991478, 0.005609998579747195, 0.010722908677744638, 0.017611134781991195], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]]),
	jnp.array([[0.9799023596419854, 0.964279902359642, 0.9557363710333605, 0.9374288039056143, 0.8998372660699756, 0.8774613506916192], [0.020097640358014646, 0.0354759967453214, 0.04369406021155411, 0.061513425549227015,
	          0.09739625711960943, 0.11651749389747762], [0.0, 0.00024410089503661513, 0.0005695687550854353, 0.0010577705451586656, 0.0027664768104149716, 0.006021155410903174], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]]),
	jnp.array([[0.9512102153611588, 0.9113779302458548, 0.884505431675243, 0.8275204878978464, 0.7951210215361159, 0.7326091099676005], [0.04878978463884124, 0.08766914427291786, 0.11301696207356585, 0.16599961882980752,
	          0.1949685534591195, 0.24852296550409758], [0.0, 0.000952925481227368, 0.0024776062511911567, 0.006479893272346103, 0.009910425004764627, 0.018867924528301886], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]]),
	jnp.array([[0.9986182240889601, 0.9939465055325869, 0.9843947053856361, 0.9660916578020989, 0.9292114007479136, 0.8545187362233652], [0.001381775911039951, 0.006053494467413118, 0.015550462236941669,
	          0.03356838145788325, 0.06985644883590862, 0.1411933718622172], [0.0, 0.0, 5.4832377422220273e-05, 0.0003399607400177657, 0.0009321504161777446, 0.004287891914417625], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]]),
	jnp.array([[0.9996411488687105, 0.9982784230536869, 0.9954893775522718, 0.9899430834851258, 0.9781600476045551, 0.9536945768054982], [0.0003588511312895474, 0.0017215769463131453, 0.004501537608961285,
	          0.009988780224122973, 0.021621916265041088, 0.045483245286104285], [0.0, 0.0, 9.084838766823986e-06, 6.81362907511799e-05, 0.00021803613040377565, 0.0008221779083975707], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]]),
	jnp.array([[0.9281267685342388, 0.878324844368987, 0.7447651386530844, 0.6830786644029428, 0.5506508205998868, 0.29541595925297115], [0.07074136955291455, 0.11884550084889643, 0.2484436898698359, 0.29711375212224106,
	          0.4165251839275608, 0.6293152235427278], [0.0011318619128466328, 0.0028296547821165816, 0.006791171477079796, 0.019807583474816072, 0.032823995472552346, 0.07130730050933787], [0.0, 0.0, 0.0, 0.0, 0.0, 0.003961516694963215]]),
	jnp.array([[0.9420552286102308, 0.7383431416930738, 0.33770937075599816, 0.10819375282933454, 0.0946129470348574, 0.08555907650520597], [0.057492077863286556, 0.2584880036215482, 0.6419194205522861, 0.8189225894069715,
	          0.8021729289271163, 0.767768220914441], [0.0004526935264825713, 0.003168854685377999, 0.020371208691715707, 0.07288365776369397, 0.10321412403802625, 0.14667270258035311], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]]),
	jnp.array([[0.8978978978978979, 0.5965965965965966, 0.5755755755755756, 0.5665665665665666, 0.5455455455455456, 0.5325325325325325], [0.1021021021021021, 0.4034034034034034, 0.4174174174174174,
	          0.4174174174174174, 0.42842842842842843, 0.42742742742742745], [0.0, 0.0, 0.007007007007007007, 0.016016016016016016, 0.026026026026026026, 0.04004004004004004], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]]),
]

TRANSITION_TENSORS_STRUCTURED_TEST_6_STEPS = [
	jnp.array([
            [
		[0.9788886192671682, 0.016106527541858772, 0.0, 0.0],
		[0.0, 0.0048228585294831355, 9.099733074496482e-05, 0.0],
		[0.0, 0.0, 9.099733074496482e-05, 0.0],
		[0.0, 0.0, 0.0, 0.0],
            ],
            [
		[0.9463722397476341, 0.032516379519534094, 0.0, 0.0],
		[0.0, 0.02068672652268867, 0.0002426595486532395, 0.0],
		[0.0, 0.0, 0.00018199466148992964, 0.0],
		[0.0, 0.0, 0.0, 0.0],
            ],
            [
		[0.9283244358165493, 0.01804780393108469, 0.0, 0.0],
		[0.0, 0.05238413006551808, 0.0008189759767046834, 0.0],
		[0.0, 0.0, 0.00042465421014316915, 0.0],
		[0.0, 0.0, 0.0, 0.0],
            ],
            [
		[0.8910761950982771, 0.03724824071827226, 0.0, 0.0],
		[0.0, 0.06903664159184664, 0.001395292404756127, 0.0],
		[0.0, 0.0, 0.0012436301868478524, 0.0],
		[0.0, 0.0, 0.0, 0.0],
            ],
            [
		[0.8690245086144139, 0.02205168648386314, 0.0, 0.0],
		[0.0, 0.10309997573404514, 0.0031849065760737685, 0.0],
		[0.0, 0.0, 0.0026389225916039795, 0.0],
		[0.0, 0.0, 0.0, 0.0],
            ],
            [
		[0.8245268138801262, 0.044497694734287795, 0.0, 0.0],
		[0.0, 0.11838752729919923, 0.006764134918709051, 0.0],
		[0.0, 0.0, 0.005641834506187818, 0.00018199466148992964],
		[0.0, 0.0, 0.0, 0.0],
            ],

	]),
	jnp.array([
            [
		[0.9382900156227808, 0.04722340576622639, 0.0, 0.0],
		[0.0, 0.014273540690242864, 0.00021303792074989347, 0.0],
		[0.0, 0.0, 0.0, 0.0],
		[0.0, 0.0, 0.0, 0.0],
            ],
            [
		[0.8447663684135777, 0.09352364720920324, 0.0, 0.0],
		[0.0, 0.060005681011219995, 0.0014912654452492544, 0.0],
		[0.0, 0.0, 0.00021303792074989347, 0.0],
		[0.0, 0.0, 0.0, 0.0],
            ],
            [
		[0.7910808123846045, 0.05368555602897316, 0.0, 0.0],
		[0.0, 0.1496236330066752, 0.0039056952137480473, 0.0],
		[0.0, 0.0, 0.0017043033659991478, 0.0],
		[0.0, 0.0, 0.0, 0.0],
            ],
            [
		[0.7599062633148701, 0.031174549069734412, 0.0, 0.0],
		[0.0, 0.1981962789376509, 0.0051129100979974435, 0.0],
		[0.0, 0.0, 0.005609998579747195, 0.0],
		[0.0, 0.0, 0.0, 0.0],
            ],
            [
		[0.7405908251668797, 0.019315438147990343, 0.0, 0.0],
		[0.0, 0.22248260190313876, 0.006888226104246556, 0.0],
		[0.0, 0.0, 0.010722908677744638, 0.0],
		[0.0, 0.0, 0.0, 0.0],
            ],
            [
		[0.7043033659991479, 0.03628745916773186, 0.0, 0.0],
		[0.0, 0.2307910808123846, 0.011006959238744497, 0.0],
		[0.0, 0.0, 0.016687970458741656, 0.0009231643232495384],
		[0.0, 0.0, 0.0, 0.0],
            ],

	]),
	jnp.array([
            [
		[0.964279902359642, 0.015622457282343368, 0.0, 0.0],
		[0.0, 0.01985353946297803, 0.00024410089503661513, 0.0],
		[0.0, 0.0, 0.0, 0.0],
		[0.0, 0.0, 0.0, 0.0],
            ],
            [
		[0.9557363710333605, 0.00854353132628153, 0.0, 0.0],
		[0.0, 0.03515052888527258, 0.00032546786004882016, 0.0],
		[0.0, 0.0, 0.00024410089503661513, 0.0],
		[0.0, 0.0, 0.0, 0.0],
            ],
            [
		[0.9374288039056143, 0.018307567127746133, 0.0, 0.0],
		[0.0, 0.04320585842148088, 0.00048820179007323027, 0.0],
		[0.0, 0.0, 0.0005695687550854353, 0.0],
		[0.0, 0.0, 0.0, 0.0],
            ],
            [
		[0.8998372660699756, 0.03759153783563873, 0.0, 0.0],
		[0.0, 0.05980471928397071, 0.001708706265256306, 0.0],
		[0.0, 0.0, 0.0010577705451586656, 0.0],
		[0.0, 0.0, 0.0, 0.0],
            ],
            [
		[0.8774613506916192, 0.022375915378356388, 0.0, 0.0],
		[0.0, 0.09414157851912124, 0.0032546786004882017, 0.0],
		[0.0, 0.0, 0.0027664768104149716, 0.0],
		[0.0, 0.0, 0.0, 0.0],
            ],
            [
		[0.8327908868999186, 0.04467046379170057, 0.0, 0.0],
		[0.0, 0.1096826688364524, 0.006834825061025224, 0.0],
		[0.0, 0.0, 0.005777054515866558, 0.00024410089503661513],
		[0.0, 0.0, 0.0, 0.0],
            ],

	]),
	jnp.array([
            [
		[0.9113779302458548, 0.039832285115303984, 0.0, 0.0],
		[0.0, 0.047836859157613876, 0.000952925481227368, 0.0],
		[0.0, 0.0, 0.0, 0.0],
		[0.0, 0.0, 0.0, 0.0],
            ],
            [
		[0.884505431675243, 0.026872498570611778, 0.0, 0.0],
		[0.0, 0.08614446350295407, 0.0015246807699637887, 0.0],
		[0.0, 0.0, 0.000952925481227368, 0.0],
		[0.0, 0.0, 0.0, 0.0],
            ],
            [
		[0.8275204878978464, 0.05698494377739661, 0.0, 0.0],
		[0.0, 0.1090146750524109, 0.004002287021154946, 0.0],
		[0.0, 0.0, 0.0024776062511911567, 0.0],
		[0.0, 0.0, 0.0, 0.0],
            ],
            [
		[0.7951210215361159, 0.032399466361730515, 0.0, 0.0],
		[0.0, 0.162569087097389, 0.003430531732418525, 0.0],
		[0.0, 0.0, 0.006479893272346103, 0.0],
		[0.0, 0.0, 0.0, 0.0],
            ],
            [
		[0.7326091099676005, 0.06251191156851534, 0.0, 0.0],
		[0.0, 0.18601105393558223, 0.00895749952353726, 0.0],
		[0.0, 0.0, 0.009910425004764627, 0.0],
		[0.0, 0.0, 0.0, 0.0],
            ],
            [
		[0.6965885267772061, 0.036020583190394515, 0.0, 0.0],
		[0.0, 0.23746902992186011, 0.01105393558223747, 0.0],
		[0.0, 0.0, 0.018296169239565466, 0.0005717552887364208],
		[0.0, 0.0, 0.0, 0.0],
            ],

	]),
	jnp.array([
            [
		[0.9939465055325869, 0.004671718556373167, 0.0, 0.0],
		[0.0, 0.001381775911039951, 0.0, 0.0],
		[0.0, 0.0, 0.0, 0.0],
		[0.0, 0.0, 0.0, 0.0],
            ],
            [
		[0.9843947053856361, 0.009551800146950772, 0.0, 0.0],
		[0.0, 0.005998662089990898, 5.4832377422220273e-05, 0.0],
		[0.0, 0.0, 0.0, 0.0],
		[0.0, 0.0, 0.0, 0.0],
            ],
            [
		[0.9660916578020989, 0.018303047583537128, 0.0, 0.0],
		[0.0, 0.015265333874346124, 0.00028512836259554544, 0.0],
		[0.0, 0.0, 5.4832377422220273e-05, 0.0],
		[0.0, 0.0, 0.0, 0.0],
            ],
            [
		[0.9292114007479136, 0.03688025705418536, 0.0, 0.0],
		[0.0, 0.03297619178172327, 0.0005921896761599789, 0.0],
		[0.0, 0.0, 0.0003399607400177657, 0.0],
		[0.0, 0.0, 0.0, 0.0],
            ],
            [
		[0.8545187362233652, 0.07469266452454845, 0.0, 0.0],
		[0.0, 0.06650070733766875, 0.0033557414982398805, 0.0],
		[0.0, 0.0, 0.0009321504161777446, 0.0],
		[0.0, 0.0, 0.0, 0.0],
            ],
            [
		[0.8120894425740511, 0.04242929364931405, 0.0, 0.0],
		[0.0, 0.13386776623860858, 0.007325605623608628, 0.0],
		[0.0, 0.0, 0.004068562404728744, 0.0002193295096888811],
		[0.0, 0.0, 0.0, 0.0],
            ],

	]),
	jnp.array([
            [
		[0.9982784230536869, 0.0013627258150235978, 0.0, 0.0],
		[0.0, 0.0003588511312895474, 0.0, 0.0],
		[0.0, 0.0, 0.0, 0.0],
		[0.0, 0.0, 0.0, 0.0],
            ],
            [
		[0.9954893775522718, 0.0027890455014149638, 0.0, 0.0],
		[0.0, 0.0017124921075463214, 9.084838766823986e-06, 0.0],
		[0.0, 0.0, 0.0, 0.0],
		[0.0, 0.0, 0.0, 0.0],
            ],
            [
		[0.9899430834851258, 0.005546294067146043, 0.0, 0.0],
		[0.0, 0.004442486156976929, 5.905145198435591e-05, 0.0],
		[0.0, 0.0, 9.084838766823986e-06, 0.0],
		[0.0, 0.0, 0.0, 0.0],
            ],
            [
		[0.9781600476045551, 0.011783035880570709, 0.0, 0.0],
		[0.0, 0.009838880384470377, 0.00014989983965259577, 0.0],
		[0.0, 0.0, 6.81362907511799e-05, 0.0],
		[0.0, 0.0, 0.0, 0.0],
            ],
            [
		[0.9536945768054982, 0.024465470799056994, 0.0, 0.0],
		[0.0, 0.02101777448704729, 0.000604141777993795, 0.0],
		[0.0, 0.0, 0.00021803613040377565, 0.0],
		[0.0, 0.0, 0.0, 0.0],
            ],
            [
		[0.9060536823122731, 0.047640894493224985, 0.0, 0.0],
		[0.0, 0.043430071724802066, 0.002053173561302221, 0.0],
		[0.0, 0.0, 0.0007994658114805108, 2.2712096917059964e-05],
		[0.0, 0.0, 0.0, 0.0],
            ],

	]),
	jnp.array([
            [
		[0.878324844368987, 0.04980192416525184, 0.0, 0.0],
		[0.0, 0.0690435766836446, 0.001697792869269949, 0.0],
		[0.0, 0.0, 0.0011318619128466328, 0.0],
		[0.0, 0.0, 0.0, 0.0],
            ],
            [
		[0.7447651386530844, 0.13355970571590267, 0.0, 0.0],
		[0.0, 0.11488398415393322, 0.003961516694963215, 0.0],
		[0.0, 0.0, 0.0028296547821165816, 0.0],
		[0.0, 0.0, 0.0, 0.0],
            ],
            [
		[0.6830786644029428, 0.06168647425014148, 0.0, 0.0],
		[0.0, 0.2354272778720996, 0.013016411997736276, 0.0],
		[0.0, 0.0, 0.006791171477079796, 0.0],
		[0.0, 0.0, 0.0, 0.0],
            ],
            [
		[0.5506508205998868, 0.13242784380305603, 0.0, 0.0],
		[0.0, 0.2840973401245048, 0.013016411997736276, 0.0],
		[0.0, 0.0, 0.019807583474816072, 0.0],
		[0.0, 0.0, 0.0, 0.0],
            ],
            [
		[0.29541595925297115, 0.2552348613469157, 0.0, 0.0],
		[0.0, 0.3740803621958121, 0.042444821731748725, 0.0],
		[0.0, 0.0, 0.028862478777589132, 0.003961516694963215],
		[0.0, 0.0, 0.0, 0.0],
            ],
            [
		[0.277306168647425, 0.018109790605546124, 0.0, 0.0],
		[0.0, 0.5947934352009054, 0.0345217883418223, 0.0],
		[0.0, 0.0, 0.06847764572722127, 0.0028296547821165816],
		[0.0, 0.0, 0.0, 0.003961516694963215],
            ],

	]),
	jnp.array([
            [
		[0.7383431416930738, 0.2037120869171571, 0.0, 0.0],
		[0.0, 0.05477591670439113, 0.002716161158895428, 0.0],
		[0.0, 0.0, 0.0004526935264825713, 0.0],
		[0.0, 0.0, 0.0, 0.0],
            ],
            [
		[0.33770937075599816, 0.4006337709370756, 0.0, 0.0],
		[0.0, 0.2412856496152105, 0.017202354006337708, 0.0],
		[0.0, 0.0, 0.003168854685377999, 0.0],
		[0.0, 0.0, 0.0, 0.0],
            ],
            [
		[0.10819375282933454, 0.22951561792666364, 0.0, 0.0],
		[0.0, 0.5894069714803079, 0.05251244907197827, 0.0],
		[0.0, 0.0, 0.020371208691715707, 0.0],
		[0.0, 0.0, 0.0, 0.0],
            ],
            [
		[0.0946129470348574, 0.013580805794477138, 0.0, 0.0],
		[0.0, 0.7885921231326392, 0.030330466274332276, 0.0],
		[0.0, 0.0, 0.07288365776369397, 0.0],
		[0.0, 0.0, 0.0, 0.0],
            ],
            [
		[0.08555907650520597, 0.009053870529651425, 0.0, 0.0],
		[0.0, 0.7587143503847895, 0.04345857854232685, 0.0],
		[0.0, 0.0, 0.10321412403802625, 0.0],
		[0.0, 0.0, 0.0, 0.0],
            ],
            [
		[0.08057944771389769, 0.004979628791308284, 0.0, 0.0],
		[0.0, 0.7320054323223177, 0.03576278859212313, 0.0],
		[0.0, 0.0, 0.13897691263014939, 0.007695789950203712],
		[0.0, 0.0, 0.0, 0.0],
            ],

	]),
	jnp.array([
            [
		[0.5965965965965966, 0.3013013013013013, 0.0, 0.0],
		[0.0, 0.1021021021021021, 0.0, 0.0],
		[0.0, 0.0, 0.0, 0.0],
		[0.0, 0.0, 0.0, 0.0],
            ],
            [
		[0.5755755755755756, 0.021021021021021023, 0.0, 0.0],
		[0.0, 0.3963963963963964, 0.007007007007007007, 0.0],
		[0.0, 0.0, 0.0, 0.0],
		[0.0, 0.0, 0.0, 0.0],
            ],
            [
		[0.5665665665665666, 0.009009009009009009, 0.0, 0.0],
		[0.0, 0.4084084084084084, 0.009009009009009009, 0.0],
		[0.0, 0.0, 0.007007007007007007, 0.0],
		[0.0, 0.0, 0.0, 0.0],
            ],
            [
		[0.5455455455455456, 0.021021021021021023, 0.0, 0.0],
		[0.0, 0.4074074074074074, 0.01001001001001001, 0.0],
		[0.0, 0.0, 0.016016016016016016, 0.0],
		[0.0, 0.0, 0.0, 0.0],
            ],
            [
		[0.5325325325325325, 0.013013013013013013, 0.0, 0.0],
		[0.0, 0.4144144144144144, 0.014014014014014014, 0.0],
		[0.0, 0.0, 0.026026026026026026, 0.0],
		[0.0, 0.0, 0.0, 0.0],
            ],
            [
		[0.5015015015015015, 0.031031031031031032, 0.0, 0.0],
		[0.0, 0.4074074074074074, 0.02002002002002002, 0.0],
		[0.0, 0.0, 0.03803803803803804, 0.002002002002002002],
		[0.0, 0.0, 0.0, 0.0],
            ],

	]),

]
